const SitesJS={requestAPI:(t,e,n)=>{let r=5;!function s(){return new Promise(((a,o)=>{let i=0,c=setTimeout((()=>{0===i&&(i=2,c=null,o("请求超时"),0==r&&n())}),5e3);fetch(t).then((function(t){if(2!==i&&(clearTimeout(c),a(t),c=null,i=1),t.ok)return t.json();throw new Error("Network response was not ok.")})).then((function(t){r=0,e(t)})).catch((function(t){r>0?(r-=1,setTimeout((()=>{s()}),5e3)):n()}))}))}()},layout:t=>{const e=$(t.el)[0];SitesJS.requestAPI(t.api,(function(n){$(e).find(".loading-wrap").remove();n.content.forEach(((n,r)=>{var s='<div class="site-card">';s+='<a class="card-link" target="_blank" rel="external nofollow noopener noreferrer" href="'+n.url+'">',s+='<img src="'+(n.screenshot||"https://image.thum.io/get/width/1024/crop/768/"+n.url)+'" onerror="javascript:this.src=\''+t.screenshot+"';\"/>",s+='<div class="info">',s+='<img src="'+(n.avatar||t.avatar)+'" onerror="javascript:this.src=\''+t.avatar+"';\"/>",s+='<span class="title">'+n.title+"</span>",s+='<span class="desc">'+(n.description||n.url)+"</span>",s+="</div>",s+="</a>",s+="</div>",$(e).find(".group-body").append(s)}))}),(function(){$(e).find(".loading-wrap svg").remove(),$(e).find(".loading-wrap p").text("加载失败，请稍后重试。")}))},start:t=>{const e=document.getElementsByClassName("sitesjs-wrap");for(var n=0;n<e.length;n++){const r=e[n],s=r.getAttribute("api");if(null!=s)(t=new Object).class=r.getAttribute("class"),t.el=r,t.api=s,t.avatar="https://cdn.jsdelivr.net/gh/cdn-x/placeholder@1.0.1/link/8f277b4ee0ecd.svg",t.screenshot="https://cdn.jsdelivr.net/gh/cdn-x/placeholder@1.0.1/cover/76b86c0226ffd.svg",SitesJS.layout(t)}}};$((function(){SitesJS.start()})),document.addEventListener("pjax:complete",(function(){SitesJS.start()}));